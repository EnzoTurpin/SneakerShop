{% extends 'base.html.twig' %}

{% block title %}
    Bienvenue sur SneakerShop
{% endblock %}

{% block body %}
  {% if app.user %}
    <div class="p-4 bg-green-100 text-green-800 text-center">
      Bienvenue, {{ app.user.username is not empty ? app.user.username : app.user.email }} !
    </div>
  {% else %}
    <div class="p-4 bg-gray-100 text-gray-800 text-center">
      Vous n'êtes pas connecté.
    </div>
  {% endif %}

  <header class="bg-white shadow">
    <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
      <a href="{{ path('landing') }}" class="text-2xl font-bold text-gray-800">
        SneakerShop
      </a>
    </nav>
  </header>

  <main class="container mx-auto px-4 py-8">
    {% set sections = {
      'Paires du moment': 'moment',
      'Ventes récentes': 'sales',
      "Sélection de l'équipe": 'team'
    } %}

    {% set images = [
      'campus.jpeg',
      'vapormax.png',
      'dunk-low.jpeg',
      'blktop-rider.jpg'
    ] %}

    {% for title, link in sections %}
      <section class="mt-12">
        <h2 class="text-2xl font-bold mb-4">{{ title }}</h2>
        <div class="carousel overflow-hidden relative">
          <div class="carousel-inner flex transition-transform duration-500">
            {% for image in images %}
              <div class="carousel-item min-w-[20%] p-2">
                <img src="{{ asset('images/' ~ image) }}" alt="Sneaker {{ loop.index }}" class="w-full h-64 object-cover rounded-lg shadow">
              </div>
            {% endfor %}
          </div>
          <button class="prev absolute top-1/2 left-0 transform -translate-y-1/2 p-2 bg-gray-800 text-white" onclick="moveSlide(-1, {{ loop.index }})">&#10094;</button>
          <button class="next absolute top-1/2 right-0 transform -translate-y-1/2 p-2 bg-gray-800 text-white" onclick="moveSlide(1, {{ loop.index }})">&#10095;</button>
        </div>
        <div class="text-center mt-4">
          <a href="{{ path(link) }}" class="text-blue-600 font-semibold">Voir toutes les paires</a>
        </div>
      </section>
    {% endfor %}
  </main>

  <script>
    function moveSlide(direction, index) {
      const carousel = document.querySelectorAll('.carousel-inner')[index - 1];
      let currentTranslate = parseInt(carousel.dataset.translate || '0');
      const maxTranslate = -(carousel.children.length - 5) * 20;
      currentTranslate += direction * 20;
      currentTranslate = Math.max(maxTranslate, Math.min(0, currentTranslate));
      carousel.style.transform = `translateX(${currentTranslate%)`;
      carousel.dataset.translate = currentTranslate;
    }
  </script>
{% endblock %}
